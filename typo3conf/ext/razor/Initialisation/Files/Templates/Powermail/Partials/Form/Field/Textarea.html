{namespace v=FluidTYPO3\Vhs\ViewHelpers}
{namespace vh=In2code\Powermail\ViewHelpers}
{namespace razor=RZ\Razor\ViewHelpers}

<div class="powermail_fieldwrap powermail_fieldwrap_type_textarea powermail_fieldwrap_{field.marker} {field.css} {settings.styles.framework.fieldAndLabelWrappingClasses}">

  <label for="powermail_field_{field.marker}" class="{settings.styles.framework.labelClasses}" title="{field.description}">
    <vh:string.RawAndRemoveXss>{field.title}</vh:string.RawAndRemoveXss><f:if condition="{field.mandatory}"><span class="mandatory">*</span></f:if>
  </label>

  <f:if condition="{field.txRazorPowermailReadonly}">
    <f:then>
      <v:variable.set name="merge" value='<razor:merge a="{vh:Validation.ValidationDataAttribute(field:field)}" b="{readonly: \'readonly\', maxlength: \'{field.txRazorPowermailMaxlength}\'}" />' />

      <f:form.textarea
        cols="20"
        rows="5"
        id="powermail_field_{field.marker}"
        property="{field.marker}"
        placeholder="{field.placeholder}"
        value="{vh:Misc.PrefillField(field:field, mail:mail)}"
        additionalAttributes="{merge}"
        class="powermail_textarea {settings.styles.framework.fieldClasses} {vh:Validation.ErrorClass(field:field, class:'powermail_field_error')}" />
    </f:then>
    <f:else>
      <v:variable.set name="merge" value='<razor:merge a="{vh:Validation.ValidationDataAttribute(field:field)}" b="{maxlength: \'{field.txRazorPowermailMaxlength}\'}" />' />

      <f:form.textarea
        cols="20"
        rows="5"
        id="powermail_field_{field.marker}"
        property="{field.marker}"
        placeholder="{field.placeholder}"
        value="{vh:Misc.PrefillField(field:field, mail:mail)}"
        additionalAttributes="{merge}"
        class="powermail_textarea {settings.styles.framework.fieldClasses} {vh:Validation.ErrorClass(field:field, class:'powermail_field_error')}" />
    </f:else>
  </f:if>
</div>
